<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Produtos - Miau Presentes</title>
  <link rel="stylesheet" href="css/style.css">
  <script>

    // Fun√ß√£o utilit√°ria para pegar o par√¢metro 'q' (query) da URL
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    document.addEventListener("DOMContentLoaded", () => {
      // ===============================================
      // 1. L√≥gica da Barra de Pesquisa (Redirecionamento)
      // ===============================================
      const searchButton = document.querySelector('.search-bar button');
      const searchInput = document.querySelector('.search-bar input');
      const performSearch = () => {
          const query = searchInput.value.trim();
          if (query) {
              // Redireciona para a p√°gina de produtos e anexa o termo de pesquisa na URL
              window.location.href = `produtos.html?q=${encodeURIComponent(query)}`;
          } else {
              // Se estiver vazio, apenas redireciona para a p√°gina de produtos (limpa a busca anterior)
              window.location.href = `produtos.html`;
          }
      };
      
      if (searchButton && searchInput) {
          searchButton.addEventListener('click', performSearch);
          searchInput.addEventListener('keypress', (e) => {
              if (e.key === 'Enter') {
                  performSearch();
              }
          });
      }

      // ===============================================
      // 2. L√≥gica para Exibir Resultados da Busca e Filtrar
      // ===============================================
      const searchQuery = getQueryParam('q');
      const titleElement = document.querySelector('section h2');

      if (searchQuery && titleElement) {
          const normalizedQuery = decodeURIComponent(searchQuery).toLowerCase();
          
          // 2.1. Atualiza o t√≠tulo para "Resultados da busca"
          titleElement.textContent = `Resultados da busca por: "${normalizedQuery}"`;

          // 2.2. L√≥gica de Filtragem de Produtos (simples)
          const productCards = document.querySelectorAll('.product-list .product-card');
          let found = false;
          
          productCards.forEach(card => {
              const name = card.querySelector('h3').textContent.toLowerCase();
              // A descri√ß√£o deve ser o <p> principal, n√£o o de estoque (.stock)
              const description = card.querySelector('p:not(.stock)').textContent.toLowerCase(); 
              
              // Verifica se o nome ou a descri√ß√£o do produto cont√©m o termo pesquisado
              if (name.includes(normalizedQuery) || description.includes(normalizedQuery)) {
                  card.style.display = 'block'; // Mostra o card
                  found = true;
              } else {
                  card.style.display = 'none'; // Esconde se n√£o for compat√≠vel
              }
          });
          
          // 2.3. Exibe mensagem de "n√£o encontrado"
          if (!found) {
              titleElement.textContent = `Nenhum resultado encontrado para: "${normalizedQuery}"`;
          }
      } else if (titleElement) {
          // Se n√£o houver query na URL, usa o t√≠tulo padr√£o
          titleElement.textContent = "Nossos Produtos";
      }

    // Mostrar aviso de estoque baixo
    document.addEventListener("DOMContentLoaded", () => {
      document.querySelectorAll(".stock").forEach(el => {
        const qtd = parseInt(el.dataset.qtd);
        if (qtd <= 5) {
          el.textContent = `‚ö† Restam apenas ${qtd} unidades!`;
          el.style.display = "block";
        } else {
          el.style.display = "none";
        }
      });

      // Fade-in animado
      const faders = document.querySelectorAll(".fade-in");
      const options = { threshold: 0.2 };
      const observer = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            entry.target.classList.add("show");
            obs.unobserve(entry.target);
          }
        });
      }, options);
      faders.forEach(fader => observer.observe(fader));
    });

    // L√≥gica do Menu Mobile 
      const menuToggle = document.querySelector('.menu-toggle');
      const navList = document.querySelector('.nav-list');
      if (menuToggle && navList) {
          menuToggle.addEventListener('click', () => {
              navList.classList.toggle('active');
          });
      }
    });

  </script>
</head>
<body>
<header>
    <a href="index.html" class="logo-link">
        <div class="logo-container">
            <img src="Miau.jpg" alt="Miau Presentes Logo" class="logo">
            <h1>Miau Presentes</h1>
        </div>
    </a>
    
    <div class="search-bar">
        <input type="text" placeholder="Buscar produtos, presentes, canecas...">
        <button type="submit" aria-label="Buscar">üîç</button>
    </div>
    
    <nav>
        <div class="menu-toggle" id="mobile-menu">
            <span></span>
            <span></span>
            <span></span>
        </div>
        <ul class="nav-list">
            <li><a href="produtos.html">Produtos</a></li>
            <li><a href="canecas.html">Canecas</a></li>
            <li><a href="sobre.html">Sobre</a></li>
            <li><a href="contato.html">Contato</a></li>
            <li><a href="admin.html">Admin</a></li>
        </ul>
    </nav>
</header>

  <!-- Barra de Promo√ß√£o -->
  <div class="promo-bar">‚ú® Frete gr√°tis para compras acima de R$ 100,00! ‚ú®</div>

  <!-- Produtos -->
<main>
    <section>
      <h2 class="fade-in">Nossos Produtos</h2>
      <p class="fade-in">Escolha o presente ideal e leve alegria para quem voc√™ ama!</p>

      <div class="product-list">
        <div class="product-card fade-in">
          <img src="imagens/presente1.jpg" alt="Kit Presente Rom√¢ntico">
          <h3>Kit Presente Rom√¢ntico</h3>
          <p>Com caneca personalizada, chocolates e mini urso.</p>
          <strong>R$ 89,00</strong>
          <button class="add-to-cart" data-name="Kit Presente Rom√¢ntico" data-price="89.00">Adicionar ao Carrinho</button>
        </div>

        <div class="product-card fade-in">
          <img src="imagens/presente2.jpg" alt="Kit Amizade">
          <h3>Kit Amizade</h3>
          <p>Ideal para presentear sua melhor amiga üíï</p>
          <strong>R$ 75,00</strong>
          <button class="add-to-cart" data-name="Kit Amizade" data-price="75.00">Adicionar ao Carrinho</button>
        </div>

        <div class="product-card fade-in">
          <img src="imagens/presente3.jpg" alt="Caixa Surpresa">
          <h3>Caixa Surpresa</h3>
          <p>Escolha os itens e monte sua pr√≥pria caixa de presente.</p>
          <strong>R$ 99,00</strong>
          <button class="add-to-cart" data-name="Caixa Surpresa" data-price="99.00">Adicionar ao Carrinho</button>
        </div>
      </div>
    </section>
  </main>


  <!-- Footer -->
  <footer>
    <p>&copy; 2025 Miau Presentes - Todos os direitos reservados.</p>
  </footer>

  <!-- Bot√£o WhatsApp Fixo -->
  <a href="https://wa.me/553599879068?text=Ol√°! Gostaria de mais informa√ß√µes sobre os produtos." 
     class="whatsapp-float" target="_blank">üí¨</a>


       <!-- SCRIPTS -->
  </script>
    <script src="js/carrosel.js"></script>
    <script src="js/search.js"></script>
    <script src="js/animation.js"></script>
    <script src="js/menu.js"></script>
    <script src="js/estoque.js"></script>
</body>
</html>
